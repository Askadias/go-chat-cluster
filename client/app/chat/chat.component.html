<div class="chat-theme chat">
  <chat-sidebar>
    <div>
      <chat-person [person]="profile">
        <button class="flat-button person-control-btn" (click)="logout()">
          <mat-icon class="md-36">exit_to_app</mat-icon>
        </button>
      </chat-person>
    </div>
    <div class="chat-groups">
      <div class="chat-group" *ngFor="let chat of rooms" [class.active]="isActiveChat(chat)" fxLayout="column">
        <a (click)="switchToChat(chat)" *ngIf="!isActiveChat(chat)" class="chat-group-overlay-btn"></a>
        <chat-person *ngFor="let memberId of chat.room.members | skipOwnFilter:profile.id"
                     (click)="!isActiveChat(chat) ? switchToChat(chat) : chatWith(memberId)"
                     [person]="chat.getUser(memberId)">
          <button class="flat-button person-control-grp-btn"
                  (click)="$event.stopPropagation(); removeFromChat(chat, memberId)"
                  *ngIf="chat.amIOwner()">
            <mat-icon class="md-36">close</mat-icon>
          </button>
        </chat-person>
      </div>
    </div>
    <mat-form-field class="friends-filter-input" floatLabel="never">
      <input matInput #nameFilter placeholder="Friends">
    </mat-form-field>
    <div class="friends" *ngIf="hasFriendsPermissions">
      <chat-person *ngFor="let friend of friends | friendsFilter:nameFilter.value; trackBy: trackByUserId"
                   (click)="chatWith(friend.id)"
                   [person]="friend">
        <button class="flat-button person-control-btn" *ngIf="canAddToCurrentChat(friend.id)"
                (click)="$event.stopPropagation(); addToCurrentChat(friend)">
          <mat-icon class="md-36">add</mat-icon>
        </button>
      </chat-person>
    </div>
    <div *ngIf="!hasFriendsPermissions">
      <button mat-raised-button fxFlex
              (click)="loginWith('facebook')"
              class="facebookBtn">
        <mat-icon svgIcon="facebook" class="fb-icon"></mat-icon>
        Allow friends access to import them from Facebook
      </button>
    </div>
  </chat-sidebar>
  <div class="chat-content">
    <div class="chat-bg"></div>
    <chat-room *ngIf="chatOpened"
               [room]="activeRoom"
               (close)="closeChat()"
               (dismiss)="dismissChat(activeRoom)"></chat-room>
  </div>
</div>
